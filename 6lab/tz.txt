Задание для лабораторной работы N 5.

Язык Ассемблера для IBM PC

Резидентные программы и функции BIOS.

Цель работы: ознакомиться с методикой написания резидентных (TSR) программ и функциями BIOS.

Задание: написать на языке Ассемблер резидентную программу в со​ответствии с вариантом задания.

Общие требования: программа должна включать в себя резидентный обработчик прерывания (в соответствии с вариантом задания), и блок инициализации. Программа должна быть подготовлена для построения в COM-формате. В программе должны быть предусмотрены средства контроля за повторной установкой. Всю необходимую программе информацию (см. задание) она должна получать из командной строки. Вывод любой инфор​мации на экран должен осуществляться в текстовом режиме с сохранением образа той части экрана, в которую осуществляется вывод. После завер​шения работы содержимое экрана должно быть восстановленно. Все дейс​твия по выводу информации должны быть реализованы посредством вызова соответствующих функций BIOS.

По желанию в программе могут быть предусмотрены средства выгруз​ки из памяти по запросу пользователя. Вид запроса на выгрузку прог​раммы - командная строка, "горячая клавиша" или другое - выбирается по усмотрению автора программы.

Вариант 1. Перехватывается прерывание 08H (таймер). Действия ре​зидентной части программы: каждые 5 секунд изменять цвет фона верхней строки экрана (например, синий-зеленый-красный-синий и т.д.).

Вариант 2. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Alt>+<C>. Действия резидентной части программы: вы​вод конфигурации PC в виде: Сопроцессор: есть/нет

Гибкие диски: есть/нет и т.д. Рекомендуется использовать 11Н прерывание BIOS.

Вариант 3. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Ctrl>+<R>. Действия резидентной части программы: Вывод на экран состояния регистров AX - DX.

Вариант 4. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Alt>+<S>. Действия резидентной части программы: вы​вод на экран состояния сегментных регистров.

Вариант 5. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>. Действия резидентной части программы: выдать звуковой сигнал (Int 10H BIOS).

Вариант 6. Перехватывается прерывание 09H (клавиатура). Действия резидентной части программы: подать звуковой сигнал при вводе с кла​виатуры "горячей" последовательности клавиш. Требуемая последователь​ность клавиш задается в строке параметров программы.

Вариант 7. Перехватывается прерывание 09H (клавиатура). Действия резидентной части программы: записывать в память все вводимые с кла​виатуры символы (но не более 32-х) в промежутке между нажатиями "го​рячей" клавиши <Ctrl>+<Alt>+<T>. Вывод содержимого буфера программы с кодами нажатых клавиш производится по нажатию клавиши <Alt>.

Вариант 8. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Ctrl>+<O>. Действия резидентной части программы: блокировка ввода с клавиатуры до повторного нажатия "горячей" клави​ши, вывод сообщения о блокировке клавиатуры с его последующим (после разблокирования) удалением.

Вариант 9. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Alt>+<F>. Действия резидентной части программы: вы​вод на экран состояния регистров флагов (побитно). После нажатия лю​бой другой клавиши восстановить содержимое экрана.

Вариант 10. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Alt>+<М>.
Действия резидентной части программы: для текстовых режимов монитора выдать на дисплей данные о текущем
 видео​режиме (номер видеорежима, число строк, столбцов и т.п.). 
После нажа​тия любой другой клавиши восстановить содержимое экрана.

Вариант 11. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>+<B>. Действия резидентной части программы: перевести монитор в черно-белый текстовый режим. Обратное переключение осущест​вляется по нажатию клавиш <Alt>+<C>.

Вариант 12. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>+<P>. Действия резидентной части программы: сохранить в буфере текущее состояние монитора (только для текстовых режимов) и записать его в файл.

Вариант 13. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>+<D>. Действия резидентной части программы: вывести на экран окно сообщения, включающее в себя текущую дату и время. При на​жатии на любую клавишу восстановить содержимое экрана.

Вариант 14. Перехватывается прерывание 09H (клавиатура). Дейст​вия резидентной части программы: при обнаружении "горячей" последова​тельности клавиш гасит экран монитора и блокирует ввод с клавиатуры. Восстанавливает содержимое экрана и разблокирует ввод при повторном вводе "горячей" последовательности. "Горячая" последовательность за​дается в строке параметров программы.

Вариант 15. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>+<Q>. Действия резидентной части программы: переключить экран на альтернативную видеостраницу и вывести на нее информационное сообщение. При повторном нажатии "горячей" клавиши восстановить акти​вную видеостраницу.

Вариант 16. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: осуществлять медленное затемнение экрана до абсолютно чёрного, затем плавное восстановление цветов до их пер​воначального состояния, затем опять затемнение и т.д.

Вариант 17. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Ctrl>+<Alt>+<S>. Действия резидентной части программы: вы​вести на экран информационное окно, в котором отображаются скан-коды всех последующих нажимаемых клавиш. Скан-коды нажатия должны предва​ряться символом "+", отпускания - символом "-". После нажатия клавиши <Esc> прекратить вывод скан-кодов и восстановить содержимое экрана.

Вариант 18. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Alt>+<S>. Действия резидентной части программы: записать определённую последовательность символов в буфер клавиатуры (в облас​ти данных BIOS). Последовательность символов задаётся в строке пара​метров программы.

Вариант 19. Перехватывается прерывание 09H (клавиатура). Дейст​вия резидентной части программы: записывать все вводимые с клавиатуры символы в файл.

Вариант 20. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: периодически (через заданный промежуток времени) заменять на всём экране строчные буквы на заглавные, заглав​ные - на строчные (т.е. менять регистр букв на противоположный). Про​межуток времени задаётся в строке параметров программы.

Вариант 21. Перехватывается прерывание 09H (клавиатура). Дейст​вия резидентной части программы: после нажатия "горячей" клавиши <Shift>+<Alt>+<D> начать дублировать каждый символ, вводимый с клави​атуры (букву, цифру и т.п.), повторно помещая его в буфер. Дублирова​ние символов прекращается после ещё одного нажатия "горячей" клавиши.

Вариант 22. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: в какой-либо строке экрана (например, верхней) отображать состояние Shift- и триггерных клавиш, если оно изменяется (для чтения текущего состояния можно воспользоваться пре​рыванием 16H BIOS).

Вариант 23. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Ctrl>+<Alt>+<I>. Действия резидентной части программы: ин​вертировать порядок символов в слове, на котором в момент активизации находится курсор. Словом может считаться последовательность букв и цифр на экране, ограниченная с двух сторон любыми другими символами (а также началом или концом строки).

Вариант 24. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: отображать на экране "улучшенные" часы, показывающие текущее время (часы, минуты, секунды) и дату (день, ме​сяц, год).

Вариант 25. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: отображать на экране время, прошедшее с момента запуска программы, а также время, прошедшее с момента послед​него перезапуска процессора (см. область данных BIOS).

Вариант 26. Перехватывается прерывание 09H (клавиатура). Дейст​вия резидентной части программы: после нажатия "горячей" клавиши <Shift>+<Ctrl>+<C> начать подсчитывать количество нажатий для каждой символьной клавиши. После повторного нажатия "горячей" клавиши прек​ратить подсчёт и записать результаты в файл.

Вариант 27. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Ctrl>+<Alt>+<A>. Действия резидентной части программы: из​менить атрибуты символов на экране так, чтобы латинские буквы отобра​жались зелёным цветом, русские буквы - красным, а цифры - жёлтым. По​сле отпускания "горячей" клавиши восстановить содержимое экрана.

Вариант 28. Перехватывается прерывание 09H (клавиатура), горячая клавиша: <Shift>+<Alt>+<R>. Действия резидентной части программы: все строки экрана переворачиваются (т.е. символы в них записываются в об​ратном порядке). После отпускания "горячей" клавиши содержимое экрана восстанавливается.

Вариант 29. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: периодически (через заданные интервалы времени) менять местами две случайно выбираемые строки на экране. Ин​тервал времени между перестановками задаётся в строке параметров про​граммы.

Вариант 30. Перехватывается прерывание 08H (таймер). Действия резидентной части программы: по экрану перемещается символ, отражаясь от краёв экрана и от любых символов, кроме пробела. Символ движется по диагонали (как бильярдный шар) со скоростью 1 клетка в секунду. Если по диагонали нет свободных соседних клеток, "шар" ждёт освобож​дения хотя бы одной из них (остаётся на месте).